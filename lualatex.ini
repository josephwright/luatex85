% $Id$
% Originally written 2008 by Karl Berry. Public domain.


\begingroup
  \catcode`\{=1 %
  \catcode`\}=2 %
  %
  \directlua{
    % Enable the primitives needed for pdftexconfig.tex to do its job.
    tex.enableprimitives("",
      {
        "pagewidth",
        "pageheight",
        "outputmode",
        "ifdefined",
        "pdfoutput",
        "pdfpagewidth",
        "pdfpageheight",
        "pdfvariable",
        "pdfcompresslevel",
        "pdfdecimaldigits",
        "pdfhorigin",
        "pdfvorigin",
        "pdfpkresolution",
        "pdfminorversion",
        "pdfobjcompresslevel"
      }
    )
  }
  % Web2c pdfTeX/XeTeX quote job names containing spaces, but LuaTeX does
  % does not do this by default; we change it via a callback, since users
  % want consistency.
  \global\everyjob{\directlua{require("lualatexquotejobname.lua")}}
\endgroup

%
\input pdftexconfig.tex

\begingroup
  \csname dvilualatex\endcsname
\endgroup

% Tidy up: perhaps this won't be required?
\let\pagewidth\undefined
\let\pageheight\undefined
\let\outputmode\undefined
\let\ifdefined\undefined
\let\pdfoutput\undefined
\let\pdfpagewidth\undefined
\let\pdfpageheight\undefined
\let\pdfvariable\undefined
\let\pdfcompresslevel\undefined
\let\pdfdecimaldigits\undefined
\let\pdfhorigin\undefined
\let\pdfvorigin\undefined
\let\pdfpkresolution\undefined
\let\pdfminorversion\undefined
\let\pdfobjcompresslevel\undefined

\input latex.ltx
